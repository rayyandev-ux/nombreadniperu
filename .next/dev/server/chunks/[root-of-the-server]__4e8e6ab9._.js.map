{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///F:/Proyectos/dniAPI/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst connectionString = process.env.DATABASE_URL;\n\nif (!connectionString) {\n  throw new Error('DATABASE_URL is missing');\n}\n\nexport const pool = new Pool({\n  connectionString,\n  ssl: { rejectUnauthorized: false },\n});\n\nexport async function query(text: string, params?: any[]) {\n  const start = Date.now();\n  const res = await pool.query(text, params);\n  const duration = Date.now() - start;\n  // console.log('executed query', { text, duration, rows: res.rowCount });\n  return res;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,IAAI,CAAC,kBAAkB;IACrB,MAAM,IAAI,MAAM;AAClB;AAEO,MAAM,OAAO,IAAI,4GAAI,CAAC;IAC3B;IACA,KAAK;QAAE,oBAAoB;IAAM;AACnC;AAEO,eAAe,MAAM,IAAY,EAAE,MAAc;IACtD,MAAM,QAAQ,KAAK,GAAG;IACtB,MAAM,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM;IACnC,MAAM,WAAW,KAAK,GAAG,KAAK;IAC9B,yEAAyE;IACzE,OAAO;AACT"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///F:/Proyectos/dniAPI/app/api/tokens/%5Btoken%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { pool } from '@/lib/db';\nimport { cookies } from 'next/headers';\nimport jwt from 'jsonwebtoken';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'secret';\n\nasync function getUserFromCookie() {\n  const cookieStore = await cookies();\n  const token = cookieStore.get('auth_token');\n  if (!token) return null;\n  try {\n    return jwt.verify(token.value, JWT_SECRET) as { user: string };\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ token: string }> }\n) {\n  const user = await getUserFromCookie();\n  if (!user) return NextResponse.json({ success: false, message: 'Unauthorized' }, { status: 401 });\n\n  const { token } = await params;\n\n  try {\n    const result = await pool.query('DELETE FROM tokens WHERE token = $1 RETURNING *', [token]);\n    if (result.rowCount && result.rowCount > 0) {\n      return NextResponse.json({ success: true, message: 'Token eliminado' });\n    }\n    return NextResponse.json({ success: false, message: 'Token no encontrado' }, { status: 404 });\n  } catch (error) {\n    return NextResponse.json({ success: false, message: 'Error deleting token' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE7C,eAAe;IACb,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC;IAC9B,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,MAAM,KAAK,EAAE;IACjC,EAAE,OAAO,GAAG;QACV,OAAO;IACT;AACF;AAEO,eAAe,OACpB,OAAgB,EAChB,EAAE,MAAM,EAA0C;IAElD,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,SAAS;QAAO,SAAS;IAAe,GAAG;QAAE,QAAQ;IAAI;IAE/F,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM;IAExB,IAAI;QACF,MAAM,SAAS,MAAM,mHAAI,CAAC,KAAK,CAAC,mDAAmD;YAAC;SAAM;QAC1F,IAAI,OAAO,QAAQ,IAAI,OAAO,QAAQ,GAAG,GAAG;YAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,SAAS;YAAkB;QACvE;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC7F,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC9F;AACF"}}]
}