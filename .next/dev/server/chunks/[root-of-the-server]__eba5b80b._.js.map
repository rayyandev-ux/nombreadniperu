{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///F:/Proyectos/dniAPI/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst connectionString = process.env.DATABASE_URL || 'postgresql://placeholder:placeholder@localhost:5432/placeholder';\n\n// Only throw in runtime (not build time) if we actually try to connect and fail, \n// OR if you prefer, keep the check but make it optional for build\nif (!process.env.DATABASE_URL && process.env.NODE_ENV !== 'production') {\n  console.warn('DATABASE_URL is missing - using placeholder for build/dev');\n}\n\nexport const pool = new Pool({\n  connectionString,\n  ssl: { rejectUnauthorized: false },\n});\n\nexport async function query(text: string, params?: any[]) {\n  const start = Date.now();\n  const res = await pool.query(text, params);\n  const duration = Date.now() - start;\n  // console.log('executed query', { text, duration, rows: res.rowCount });\n  return res;\n}\n"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY,IAAI;AAErD,kFAAkF;AAClF,kEAAkE;AAClE,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,IAAI,oDAAyB,cAAc;IACtE,QAAQ,IAAI,CAAC;AACf;AAEO,MAAM,OAAO,IAAI,4GAAI,CAAC;IAC3B;IACA,KAAK;QAAE,oBAAoB;IAAM;AACnC;AAEO,eAAe,MAAM,IAAY,EAAE,MAAc;IACtD,MAAM,QAAQ,KAAK,GAAG;IACtB,MAAM,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM;IACnC,MAAM,WAAW,KAAK,GAAG,KAAK;IAC9B,yEAAyE;IACzE,OAAO;AACT"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///F:/Proyectos/dniAPI/utils/dniPeruAuth.js"],"sourcesContent":["const axios = require('axios');\n\n// Cache simple en memoria para los tokens\nlet cachedTokens = null;\n\n/**\n * Obtiene los tokens de seguridad de dniperu.com.\n * Si forceRefresh es true, ignora el cache y busca nuevos tokens.\n */\nasync function getDniPeruTokens(forceRefresh = false) {\n    if (cachedTokens && !forceRefresh) {\n        return cachedTokens;\n    }\n\n    try {\n        console.log('Obteniendo tokens de seguridad de dniperu.com...');\n        const response = await axios.get('https://dniperu.com/buscar-dni-por-nombre/', {\n            headers: {\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n                'Referer': 'https://dniperu.com/'\n            },\n            timeout: 5000\n        });\n        \n        const html = response.data;\n        \n        // Buscamos la variable dni_vars que contiene los tokens\n        const dniVarsMatch = html.match(/var dni_vars = ({[^;]+});/);\n        \n        if (dniVarsMatch && dniVarsMatch[1]) {\n            try {\n                const data = JSON.parse(dniVarsMatch[1]);\n                const tokens = {\n                    security: data.nonce,\n                    cc_token: data.ephemeral_token,\n                    cc_sig: data.ephemeral_sig\n                };\n                \n                if (tokens.security && tokens.cc_token && tokens.cc_sig) {\n                    console.log('Tokens obtenidos exitosamente:', tokens);\n                    cachedTokens = tokens; // Guardamos en cache\n                    return tokens;\n                }\n            } catch (e) {\n                console.error('Error parseando JSON de dni_vars:', e.message);\n            }\n        } else {\n            console.warn('No se encontró la variable dni_vars en el HTML');\n        }\n        \n        return null;\n    } catch (error) {\n        console.error('Error conectando con dniperu.com para obtener tokens:', error.message);\n        return null;\n    }\n}\n\n/**\n * Realiza la búsqueda en DniPeru manejando tokens y reintentos en caso de 403.\n * @param {Object} params - { nombres, apellido_paterno, apellido_materno }\n */\nasync function searchDniPeru(params) {\n    let tokens = await getDniPeruTokens();\n    \n    // Si no hay tokens ni siquiera tras intentar obtenerlos, usamos fallbacks (aunque probablemente fallen)\n    let security = tokens?.security || '37ea666f56';\n    let cc_token = tokens?.cc_token || 'f7ce510e99a3cb26b98d90c3514659ca';\n    let cc_sig = tokens?.cc_sig || '761d4f9306bc19a678a7b8708b1d0374e0ba967712748636ea722e25e6f6235c';\n\n    const makeRequest = async (currentSecurity, currentCcToken, currentCcSig) => {\n        const formData = new URLSearchParams();\n        formData.append('action', 'buscar_dni');\n        if (params.nombres) formData.append('nombres', params.nombres);\n        if (params.apellido_paterno) formData.append('apellido_paterno', params.apellido_paterno);\n        if (params.apellido_materno) formData.append('apellido_materno', params.apellido_materno);\n\n        formData.append('security', currentSecurity);\n        formData.append('cc_token', currentCcToken);\n        formData.append('cc_sig', currentCcSig);\n\n        return axios.post('https://dniperu.com/wp-admin/admin-ajax.php', formData, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n                'Origin': 'https://dniperu.com',\n                'Referer': 'https://dniperu.com/',\n                'X-Requested-With': 'XMLHttpRequest'\n            },\n            timeout: 8000\n        });\n    };\n\n    try {\n        // Primer intento\n        return await makeRequest(security, cc_token, cc_sig);\n    } catch (error) {\n        // Si es error 403, intentamos refrescar tokens y reintentar una vez\n        if (error.response && error.response.status === 403) {\n            console.log('Error 403 detectado. Refrescando tokens y reintentando...');\n            tokens = await getDniPeruTokens(true); // Forzar refresh\n            \n            if (tokens) {\n                security = tokens.security;\n                cc_token = tokens.cc_token;\n                cc_sig = tokens.cc_sig;\n                \n                // Segundo intento\n                return await makeRequest(security, cc_token, cc_sig);\n            }\n        }\n        // Si no es 403 o falló el refresh, lanzamos el error original\n        throw error;\n    }\n}\n\nmodule.exports = { getDniPeruTokens, searchDniPeru };\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,0CAA0C;AAC1C,IAAI,eAAe;AAEnB;;;CAGC,GACD,eAAe,iBAAiB,eAAe,KAAK;IAChD,IAAI,gBAAgB,CAAC,cAAc;QAC/B,OAAO;IACX;IAEA,IAAI;QACA,QAAQ,GAAG,CAAC;QACZ,MAAM,WAAW,MAAM,MAAM,GAAG,CAAC,8CAA8C;YAC3E,SAAS;gBACL,cAAc;gBACd,WAAW;YACf;YACA,SAAS;QACb;QAEA,MAAM,OAAO,SAAS,IAAI;QAE1B,wDAAwD;QACxD,MAAM,eAAe,KAAK,KAAK,CAAC;QAEhC,IAAI,gBAAgB,YAAY,CAAC,EAAE,EAAE;YACjC,IAAI;gBACA,MAAM,OAAO,KAAK,KAAK,CAAC,YAAY,CAAC,EAAE;gBACvC,MAAM,SAAS;oBACX,UAAU,KAAK,KAAK;oBACpB,UAAU,KAAK,eAAe;oBAC9B,QAAQ,KAAK,aAAa;gBAC9B;gBAEA,IAAI,OAAO,QAAQ,IAAI,OAAO,QAAQ,IAAI,OAAO,MAAM,EAAE;oBACrD,QAAQ,GAAG,CAAC,kCAAkC;oBAC9C,eAAe,QAAQ,qBAAqB;oBAC5C,OAAO;gBACX;YACJ,EAAE,OAAO,GAAG;gBACR,QAAQ,KAAK,CAAC,qCAAqC,EAAE,OAAO;YAChE;QACJ,OAAO;YACH,QAAQ,IAAI,CAAC;QACjB;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yDAAyD,MAAM,OAAO;QACpF,OAAO;IACX;AACJ;AAEA;;;CAGC,GACD,eAAe,cAAc,MAAM;IAC/B,IAAI,SAAS,MAAM;IAEnB,wGAAwG;IACxG,IAAI,WAAW,QAAQ,YAAY;IACnC,IAAI,WAAW,QAAQ,YAAY;IACnC,IAAI,SAAS,QAAQ,UAAU;IAE/B,MAAM,cAAc,OAAO,iBAAiB,gBAAgB;QACxD,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,UAAU;QAC1B,IAAI,OAAO,OAAO,EAAE,SAAS,MAAM,CAAC,WAAW,OAAO,OAAO;QAC7D,IAAI,OAAO,gBAAgB,EAAE,SAAS,MAAM,CAAC,oBAAoB,OAAO,gBAAgB;QACxF,IAAI,OAAO,gBAAgB,EAAE,SAAS,MAAM,CAAC,oBAAoB,OAAO,gBAAgB;QAExF,SAAS,MAAM,CAAC,YAAY;QAC5B,SAAS,MAAM,CAAC,YAAY;QAC5B,SAAS,MAAM,CAAC,UAAU;QAE1B,OAAO,MAAM,IAAI,CAAC,+CAA+C,UAAU;YACvE,SAAS;gBACL,gBAAgB;gBAChB,cAAc;gBACd,UAAU;gBACV,WAAW;gBACX,oBAAoB;YACxB;YACA,SAAS;QACb;IACJ;IAEA,IAAI;QACA,iBAAiB;QACjB,OAAO,MAAM,YAAY,UAAU,UAAU;IACjD,EAAE,OAAO,OAAO;QACZ,oEAAoE;QACpE,IAAI,MAAM,QAAQ,IAAI,MAAM,QAAQ,CAAC,MAAM,KAAK,KAAK;YACjD,QAAQ,GAAG,CAAC;YACZ,SAAS,MAAM,iBAAiB,OAAO,iBAAiB;YAExD,IAAI,QAAQ;gBACR,WAAW,OAAO,QAAQ;gBAC1B,WAAW,OAAO,QAAQ;gBAC1B,SAAS,OAAO,MAAM;gBAEtB,kBAAkB;gBAClB,OAAO,MAAM,YAAY,UAAU,UAAU;YACjD;QACJ;QACA,8DAA8D;QAC9D,MAAM;IACV;AACJ;AAEA,OAAO,OAAO,GAAG;IAAE;IAAkB;AAAc"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///F:/Proyectos/dniAPI/app/api/buscar-dni/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { pool } from '@/lib/db';\nimport axios from 'axios';\nimport jwt from 'jsonwebtoken';\nimport { cookies } from 'next/headers';\n// @ts-ignore\nimport { searchDniPeru } from '@/utils/dniPeruAuth';\n\nconst JWT_SECRET = process.env.JWT_SECRET || 'secret';\nconst API_TOKEN = process.env.API_TOKEN;\n\n// Helper to validate request (Bearer or Cookie)\nasync function isAuthenticated(request: Request) {\n  // 1. Check Cookie (Dashboard use)\n  const cookieStore = await cookies();\n  const cookieAuth = cookieStore.get('auth_token');\n  if (cookieAuth) {\n    try {\n      const decoded = jwt.verify(cookieAuth.value, JWT_SECRET);\n      return { type: 'session', user: decoded };\n    } catch (e) {}\n  }\n\n  // 2. Check Bearer Token (API use)\n  const authHeader = request.headers.get('authorization');\n  const token = authHeader && authHeader.split(' ')[1];\n  if (!token) return null;\n\n  // Legacy static token\n  if (token === API_TOKEN) return { type: 'static', token };\n\n  // Database JWT\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET);\n    // Verify DB\n    const result = await pool.query('SELECT * FROM tokens WHERE token = $1', [token]);\n    if (result.rows.length === 0) return null;\n    \n    // Update usage\n    await pool.query(\n      'UPDATE tokens SET usage_count = usage_count + 1, last_used = NOW() WHERE token = $1',\n      [token]\n    );\n    return { type: 'api', user: decoded };\n  } catch (e) {\n    return null;\n  }\n}\n\nexport async function POST(request: Request) {\n  const auth = await isAuthenticated(request);\n  if (!auth) {\n    return NextResponse.json({ success: false, message: 'No autorizado' }, { status: 401 });\n  }\n\n  try {\n    const body = await request.json();\n    const { dni, nombres, apellido_paterno, apellido_materno, security, cc_token, cc_sig } = body;\n\n    // Load user settings if authenticated via DB token\n    let factilizaToken = process.env.FACTILIZA_TOKEN;\n    let dniPeruConfig = {\n        security: security || '37ea666f56',\n        cc_token: cc_token || 'f7ce510e99a3cb26b98d90c3514659ca',\n        cc_sig: cc_sig || '761d4f9306bc19a678a7b8708b1d0374e0ba967712748636ea722e25e6f6235c'\n    };\n\n    const authUser = auth.user as any;\n    if (authUser?.user) { // If we have a user ID (from dashboard session or user-tied token)\n        try {\n            const settingsRes = await pool.query('SELECT * FROM user_settings WHERE user_id = $1', [authUser.user]);\n            if (settingsRes.rows.length > 0) {\n                const s = settingsRes.rows[0];\n                if (s.factiliza_token) factilizaToken = s.factiliza_token;\n                if (s.dniperu_security) dniPeruConfig.security = s.dniperu_security;\n                if (s.dniperu_cc_token) dniPeruConfig.cc_token = s.dniperu_cc_token;\n                if (s.dniperu_cc_sig) dniPeruConfig.cc_sig = s.dniperu_cc_sig;\n            }\n        } catch (e) {\n            console.error('Error loading user settings:', e);\n        }\n    }\n\n    if (!dni && (!nombres || !apellido_paterno || !apellido_materno)) {\n        return NextResponse.json({ success: false, message: 'Debe ingresar DNI o Nombres y Apellidos' }, { status: 400 });\n    }\n\n    // --- CACHE LOGIC START ---\n    let cacheKey = '';\n    const generateNameKey = (n: string, p: string, m: string) => {\n        return `NAME:${n?.trim().toUpperCase() || ''}|${p?.trim().toUpperCase() || ''}|${m?.trim().toUpperCase() || ''}`;\n    };\n\n    if (dni) {\n        cacheKey = `DNI:${dni.trim()}`;\n    } else {\n        cacheKey = generateNameKey(nombres, apellido_paterno, apellido_materno);\n    }\n\n    try {\n        const cacheResult = await pool.query('SELECT data FROM search_cache WHERE query_key = $1', [cacheKey]);\n        if (cacheResult.rows.length > 0) {\n            return NextResponse.json({\n                success: true,\n                source: 'cache',\n                data: cacheResult.rows[0].data,\n                message: 'Data recuperada de cache'\n            });\n        }\n    } catch (e) {\n        console.error('Cache read error:', e);\n        // Continue without cache if error\n    }\n    // --- CACHE LOGIC END ---\n\n    let debugErrors: any = {};\n    let finalData = null;\n\n    // 1. DNI Search (Factiliza)\n    if (dni) {\n        try {\n            const factilizaResponse = await axios.get(`https://api.factiliza.com/v1/dni/info/${dni}`, {\n                headers: { 'Authorization': `Bearer ${process.env.FACTILIZA_TOKEN}` },\n                timeout: 5000\n            });\n\n            if (factilizaResponse.data?.success) {\n                finalData = factilizaResponse.data.data;\n                 \n                // Save to cache (DNI Key)\n                try {\n                     await pool.query(\n                        'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                        [cacheKey, finalData]\n                    );\n                } catch (e) { console.error('Cache write error:', e); }\n\n                // SMART CACHE: Also save by Name\n                if (finalData.nombres && finalData.apellido_paterno && finalData.apellido_materno) {\n                    const nameKey = generateNameKey(finalData.nombres, finalData.apellido_paterno, finalData.apellido_materno);\n                    try {\n                        await pool.query(\n                           'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                           [nameKey, finalData]\n                       );\n                   } catch (e) { console.error('Smart Cache (Name) write error:', e); }\n                }\n\n                 return NextResponse.json({\n                    success: true,\n                    source: 'factiliza',\n                    data: finalData,\n                    original_results: []\n                });\n            }\n            debugErrors.factiliza = 'Success false';\n        } catch (error: any) {\n            debugErrors.factiliza = error.message;\n        }\n    }\n\n    // 2. Name Search (DniPeru) -> Solo si no hay DNI\n    if (!dni && (nombres || apellido_paterno || apellido_materno)) {\n        try {\n            const response = await searchDniPeru({\n                nombres,\n                apellido_paterno,\n                apellido_materno\n            });\n\n            if (response.data?.success && response.data.data?.resultados?.length > 0) {\n                 const datos = response.data.data.resultados[0];\n                 finalData = datos;\n                 \n                 // Enrich with Factiliza if DNI found\n                 if (datos.numero) {\n                     // SMART CACHE: Check if DNI is already cached before calling Factiliza\n                     const dniKey = `DNI:${datos.numero.trim()}`;\n                     let cachedDniData = null;\n                     \n                     try {\n                         const dniCacheRes = await pool.query('SELECT data FROM search_cache WHERE query_key = $1', [dniKey]);\n                         if (dniCacheRes.rows.length > 0) {\n                             cachedDniData = dniCacheRes.rows[0].data;\n                         }\n                     } catch(e) {}\n\n                     if (cachedDniData) {\n                         finalData = cachedDniData;\n                         // Update Name Cache with this high-quality data\n                         try {\n                            await pool.query(\n                                'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                                [cacheKey, finalData]\n                            );\n                        } catch (e) { console.error('Cache write error:', e); }\n\n                         return NextResponse.json({\n                            success: true,\n                            source: 'cache_via_dni_lookup',\n                            data: finalData,\n                            original_results: [datos]\n                        });\n                     } else {\n                         // Not in cache, call Factiliza\n                         try {\n                            const fRes = await axios.get(`https://api.factiliza.com/v1/dni/info/${datos.numero}`, {\n                                headers: { 'Authorization': `Bearer ${factilizaToken}` },\n                                timeout: 5000\n                            });\n                            if (fRes.data?.success) {\n                                finalData = fRes.data.data;\n                                \n                                // Save to cache (Name Key)\n                                try {\n                                    await pool.query(\n                                        'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                                        [cacheKey, finalData]\n                                    );\n                                } catch (e) { console.error('Cache write error:', e); }\n\n                                // SMART CACHE: Also save by DNI\n                                try {\n                                    await pool.query(\n                                        'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                                        [dniKey, finalData]\n                                    );\n                                } catch (e) { console.error('Smart Cache (DNI) write error:', e); }\n\n                                return NextResponse.json({\n                                    success: true,\n                                    source: 'factiliza_via_name',\n                                    data: finalData,\n                                    original_results: [datos]\n                                });\n                            }\n                         } catch (e) {}\n                     }\n                 }\n\n                 // Save to cache (raw data if enrichment failed or no DNI)\n                 try {\n                    await pool.query(\n                        'INSERT INTO search_cache (query_key, data) VALUES ($1, $2) ON CONFLICT (query_key) DO UPDATE SET data = $2, created_at = NOW()',\n                        [cacheKey, finalData]\n                    );\n                } catch (e) { console.error('Cache write error:', e); }\n\n                 return NextResponse.json({\n                    success: true,\n                    source: 'dniperu',\n                    data: finalData,\n                    original_results: [datos]\n                });\n            }\n            debugErrors.dniPeru = 'No results';\n        } catch (error: any) {\n            debugErrors.dniPeru = error.message;\n        }\n    }\n\n    return NextResponse.json({ success: false, message: 'No se encontraron resultados', debug: debugErrors }, { status: 404 });\n\n  } catch (error: any) {\n    return NextResponse.json({ success: false, message: 'Error interno', details: error.message }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":"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"}}]
}